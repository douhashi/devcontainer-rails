<div class="video-generation-section">
  <% if video_exists? %>
    <!-- Video Player and Information Layout -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4">
      <!-- Left: Video Player -->
      <div class="aspect-video">
        <% if video_status == "completed" && video_file_url %>
          <video controls class="w-full h-full rounded-lg bg-gray-900">
            <source src="<%= video_file_url %>" type="video/mp4">
            お使いのブラウザは動画再生をサポートしていません。
          </video>
        <% else %>
          <div class="w-full h-full bg-gray-900 rounded-lg flex items-center justify-center">
            <div class="text-center">
              <div class="text-4xl mb-2">🎬</div>
              <p class="text-gray-400 text-sm">
                <% case video_status %>
                <% when 'pending' %>
                  生成待機中
                <% when 'processing' %>
                  生成中...
                <% when 'failed' %>
                  生成失敗
                <% else %>
                  動画なし
                <% end %>
              </p>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Right: Information and Actions -->
      <div class="space-y-4">
        <!-- Basic Information Section -->
        <% if video_info[:resolution] || video_info[:file_size] || video_info[:duration_seconds] || formatted_generation_duration %>
          <div class="bg-gray-900 rounded-lg p-3 space-y-2">
            <% if video_info[:resolution] %>
              <div class="flex justify-between text-sm">
                <span class="text-gray-400">解像度:</span>
                <span class="text-gray-200"><%= video_info[:resolution] %></span>
              </div>
            <% end %>
            <% if video_info[:file_size] %>
              <div class="flex justify-between text-sm">
                <span class="text-gray-400">ファイルサイズ:</span>
                <span class="text-gray-200"><%= formatted_file_size(video_info[:file_size]) %></span>
              </div>
            <% end %>
            <% if video_info[:duration_seconds] %>
              <div class="flex justify-between text-sm">
                <span class="text-gray-400">再生時間:</span>
                <span class="text-gray-200"><%= formatted_duration(video_info[:duration_seconds]) %></span>
              </div>
            <% end %>
            <% if formatted_generation_duration && (video_status == "completed" || video_status == "processing") %>
              <div class="flex justify-between text-sm">
                <span class="text-gray-400">生成時間:</span>
                <span class="text-gray-200"><%= formatted_generation_duration %></span>
              </div>
            <% end %>
          </div>
        <% end %>

        <!-- Technical Specifications -->
        <div class="bg-gray-900 rounded-lg p-3">
          <h4 class="text-sm font-medium text-gray-200 mb-2">技術仕様</h4>
          <div class="space-y-1 text-xs">
            <% technical_specs.each do |key, value| %>
              <div class="flex justify-between">
                <span class="text-gray-400"><%= key.to_s.humanize %>:</span>
                <span class="text-gray-200"><%= value %></span>
              </div>
            <% end %>
          </div>
        </div>


        <!-- Error Message (for failed videos) -->
        <% if video_status == "failed" && content_record.video.error_message %>
          <div class="bg-red-900 bg-opacity-20 border border-red-500 rounded-lg p-3">
            <p class="text-red-400 text-sm">
              エラー: <%= content_record.video.error_message %>
            </p>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Generate/Processing Button (when no video exists or processing) -->
  <% unless video_exists? && (video_status == "completed" || video_status == "failed") %>
    <div class="flex items-center gap-2">
      <%= form_with url: content_video_path(content_record), method: :post, local: true do |f| %>
        <%= render Button::Component.new(
          text: button_text,
          variant: button_variant,
          size: button_size,
          disabled: button_disabled?,
          loading: button_loading?,
          type: "submit",
          data: button_data_attributes
        ) do %>
          <% if !button_loading? && button_icon %>
            <%= render Icon::Component.new(name: button_icon, size: :sm) %>
          <% end %>
          <span class="<%= 'ml-1.5' if button_icon && !button_loading? %>"><%= button_text %></span>
        <% end %>
      <% end %>
      
      <!-- Prerequisites hint (when disabled) -->
      <% if !video_exists? && !can_generate_video? && prerequisite_errors.any? %>
        <span class="text-xs text-gray-500">
          <%= prerequisite_errors.join(" / ") %>
        </span>
      <% end %>
    </div>
  <% end %>
</div>

