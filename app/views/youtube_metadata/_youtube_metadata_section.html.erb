<div id="youtube-metadata-section-<%= content.id %>">
  <% if content.youtube_metadata.present? %>
    <!-- YouTube メタデータが存在する場合 -->
    <div class="youtube-metadata-management-container">
      <%= render 'youtube_metadata/youtube_metadata_display', youtube_metadata: content.youtube_metadata %>

      <!-- 編集・削除ボタン -->
      <div class="mt-4 flex justify-end gap-2">
        <%
          next_status = case content.youtube_metadata.status
          when 'draft' then 'ready'
          when 'ready' then 'published'
          when 'published' then 'draft'
          else 'draft'
          end
        %>
        <% if content.youtube_metadata.can_transition_to?(next_status) %>
          <%= button_to content_youtube_metadata_path(content),
                        method: :patch,
                        params: { youtube_metadata: { status: next_status } },
                        data: {
                          turbo_method: :patch
                        },
                        'aria-label': 'ステータス変更',
                        title: "#{I18n.t("enumerize.youtube_metadata.status.#{next_status}")}にする",
                        class: "inline-flex items-center justify-center px-4 py-2 #{next_status == 'published' ? 'bg-green-600 hover:bg-green-700' : 'bg-blue-600 hover:bg-blue-700'} text-white rounded-lg transition-colors text-sm" do %>
            <%= I18n.t("enumerize.youtube_metadata.status.#{next_status}") %>
          <% end %>
        <% end %>

        <%= link_to "#",
                    data: {
                      controller: "modal",
                      action: "click->modal#open",
                      modal_target_value: "youtube-metadata-edit-modal-#{content.youtube_metadata.id}"
                    },
                    'aria-label': 'YouTube メタデータを編集',
                    title: 'YouTube メタデータを編集',
                    class: "inline-flex items-center justify-center p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors" do %>
          <%= render Icon::Component.new(name: "edit") %>
        <% end %>

        <%= button_to content_youtube_metadata_path(content),
                      method: :delete,
                      data: {
                        turbo_method: :delete,
                        turbo_confirm: "YouTube メタデータを削除しますか？"
                      },
                      'aria-label': 'YouTube メタデータを削除',
                      title: 'YouTube メタデータを削除',
                      class: "inline-flex items-center justify-center p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors" do %>
          <%= render Icon::Component.new(name: "delete") %>
        <% end %>
      </div>
    </div>

    <!-- 編集モーダル -->
    <div id="youtube-metadata-edit-modal-<%= content.youtube_metadata.id %>"
         data-modal-target="modal"
         class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
        <h3 class="text-lg font-semibold text-white mb-4">YouTube メタデータを編集</h3>
        <%= render 'youtube_metadata/form', content: content, youtube_metadata: content.youtube_metadata %>
      </div>
    </div>
  <% else %>
    <!-- YouTube メタデータが存在しない場合 -->
    <turbo-frame id="youtube-metadata-section-<%= content.id %>">
      <%= render 'youtube_metadata/new_form', content: content %>
    </turbo-frame>
  <% end %>
</div>